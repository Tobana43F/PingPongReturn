# PingPongReturn

## 🎮ゲーム紹介

|||
|---|---|
|タイトル|PingPongReturn| 
|ジャンル|スポーツゲーム| 
|プレイ人数|1人| 
|動作環境|Windows| 

### ゲーム概要

卓球のレシーブを題材にしたゲームです。  
サーブフォームから回転を見極め、コースを狙って返球し、ハイスコアを目指すことが目的のミニゲームです。

他の卓球ゲームであまり取りだたされていない「回転」に注目。  
「相手のサーブを見切って、コースを狙って返球する。」という卓球の気持ちよさを表現しました。

## 🛠️技術的な見どころ

### Nintendo Switch の Joy-Conを使った直観的な操作

JoyconLib というライブラリを使用して、Unity上でJoy-Conを利用できます。  
Joy-Conの6軸センサーを活用し、ラケットの角度、返球の強さを直観的に操作できます。

### Assembly Definition Files を用いたスコープ管理

Assembly Definition Files (ADF)を用いることで、アセンブリを分割することができます。  
クラスやモジュールの依存関係を強制することで、ライブラリ同士の干渉を最小限に抑え、安全で効率的に開発を進めることができます。

この制作では、不要な参照関係を生まないために、検証環境用にSandbox ADFを作成したり、  
グラフィックアセットと関連が強いスクリプト向けに、GraphicsAssets ADFを作成したりしています。

### アニメーションに合わせた制御

モデルのアニメーションに、ボールをトスするタイミングや、打球するタイミングでイベントを埋め込み、
スクリプト側でイベントを購読することで制御を行っています。

トスから打球するまでのボールの制御は、以下の情報をもとにベジェ曲線で制御している。
- 手にあるボールを持つロケーター位置
- 打点のロケーター位置
- トスイベントから打球イベントまでの時間

また、自然なトスになるように、トスから打球までにかかる時間を求め、トスの高さを決めている。

<img height="300" alt="アニメーションイベント" src="https://github.com/user-attachments/assets/bc916645-18f7-4561-a1a6-a13785d6ecdb" />

## ✨こだわり・アピールポイント

### 遊びをコントロールするためのボールの制御

トスは前述のとおりアニメーションに合わせるため、プログラムで動きを制御。

サーブ後は物理的な挙動が重要なので、RigidBodyを使った物理挙動を行い、  
それに加え、ボールの回転で発生する揚力（マグヌス効果）を再現するための力を加えています。

レシーブ時やレシーブ後の挙動は、  
物理制御では挙動が乱れたり、気持ちの良い返球にならないことを懸念して、  
打球時にプログラムで正しく返球できたかどうかや、着弾点を計算し、プログラムでの制御を行っています。

着弾点を返球した瞬間に計算することで、ぎりぎり入らない球を入るように補正したり、演出を加えたりなど、  
遊びを柔軟にコントロールできるようになっています。

### サーブアニメーションの作成

実際の卓球でサーブを見切るためには、相手のサーブモーションをよく観察する必要があります。  
そのためサーブのアニメーションは遊びを成立させるために重要な要素でした。  
実際の体験に近づけるために、Blenderを用いて、回転方向が分かるようなモーションを1から作成しました。

<img height="300" alt="アニメーション編集" src="https://github.com/user-attachments/assets/e51644f2-4f45-4b1a-a770-6b9058ec490d" />

### 実装する要素の取捨選択

3週間という期間で作品を完成させるために、対応する内容の優先順位を正しく把握し、  
最も大事とする「相手のサーブを見切って、コースを狙って返球する。」という体験が十分に遊べる状態に仕上げることができました。

タイトル、リザルト、チュートリアルなどは、ゲームとして必須な要素ですが、  
ゲームの体験につながる部分を優先し、思い切って実装しないことに決めました。

## 🔍自己レビュー

### ボールの回転を強調すると遊びやすい

相手のサーブモーションが回転方向のヒントになっていますが、未経験者に遊んでもらうには難しい。  
特に回転量についてはさらに分かりづらく、どのように角度を合わせたら良いかも経験が必要。  

ボールにはマークが書かれていて、その動きから回転が分かるが、見せることを意図していないサイズになっている。

よりゲームとして楽しんでもらうためには、回転量を直観的にわかるようにするのが良い。  
回転エフェクトなどを付け、回転方向と回転量のヒントを加えることでより遊びやすくなる。

## 🛠開発情報

|||
|---|---|
|開発環境|Unity, C#|
|開発人数|1人|
|開発時期|2023年|
|開発期間|3週間|

### 使用ツール

- Unity
- Visual Studio
- Plastic SCM (Unity VC)
- Blender
- GIMP2
- Audacity
